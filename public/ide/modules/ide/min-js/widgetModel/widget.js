!function(e){if("function"==typeof define&&define.amd)define("WidgetModel",["./layer"],e);else if("object"==typeof module&&module.exports){console.log(__dirpath);var n=require("./layer");module.exports=e(n)}else window.WidgetModel=e(window.LayerModel)}(function(e){function n(e,n,t,s,a){this.info={left:e,top:n,width:t,height:s},this.tag="defaultTag",this.type="general",this.mode=0,a&&a.length?this.layers=a:this.layers=[new r(t,s)]}function t(e,n){this.type=e,this.value=n}function s(e,t,s,a,h,p,u){var d=new r(0,0,s,a);d.subLayers.font=new i(s,a,h,p),d.subLayers.texture=new o(s,a,u[0].imgSrc),d.subLayers.color=new w(s,a,u[0].color);var l=new r(0,0,s,a);l.subLayers.font=new i(s,a,h,p),l.subLayers.texture=new o(s,a,u[1].imgSrc),l.subLayers.color=new w(s,a,u[1].color);var c=[d,l];this.subType="Button",n.call(this,e,t,s,a,c)}function a(e,t,s,a,i,h,p,u){var d=0,l=0,c=[];if(0==h){d=(s-(i-1)*p)/i,l=a;for(var g=0;g<i;g++){var y=new r(g*(d+p)+e,t,d,d);y.subLayers.texture=new o(d,l,u[2*g].imgSrc),y.subLayers.color=new w(d,l,u[2*g].color);var f=new r(g*(d+p)+e,t,d,d,(!0));f.subLayers.texture=new o(d,l,u[2*g+1].imgSrc),f.subLayers.color=new w(d,l,u[2*g+1].color),c.push(y),c.push(f)}}else{d=s,l=(a-(i-1)*p)/i;for(var g=0;g<i;g++){var m=new r(e,t+g*(l+p),d,d);m.subLayers.texture=new o(d,l,u[g].imgSrc),m.subLayers.color=new w(d,l,u[g].color),c.push(m)}}this.subType="ButtonGroup",n.call(this,e,t,s,a,c)}var r=e.Layer,i=(e.ROISubLayer,e.FontSubLayer),o=e.TextureSubLayer,w=e.ColorSubLayer;n.prototype.toObject=function(){return{info:{left:this.info.left,top:this.info.top,width:this.info.width,height:this.info.height},mode:this.mode,tag:this.tag,layers:this.layers}},n.prototype.commands={},n.execute=function(e,n,t){return"__tag"==n?this.getTag(e.tag):"string"==typeof n?'"'+n+'"':n};var h="Int",p="ID",u="EXP";s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.commands={},s.prototype.commands.onInitialize=[["temp","a",new t(u,"this.mode")],["setTag",new t(h,1)],["set",new t(p,"a"),new t(h,3)],["if"],["gte",new t(p,"a"),new t(h,100)],["set",new t(u,"this.layers.1.hidden"),new t(h,1)],["else"],["set",new t(u,"this.layers.1.hidden"),new t(h,0)],["end"]],s.prototype.commands.onMouseDown=[["temp","b",new t(u,"this.mode")],["if"],["eq",new t(p,"b"),new t(h,0)],["set",new t(u,"this.layers.0.hidden"),new t(h,1)],["set",new t(u,"this.layers.1.hidden"),new t(h,0)],["setTag",new t(h,0)],["else"],["temp","c",new t(h,0)],["getTag","c"],["if"],["gt",new t(p,"c"),new t(h,0)],["setTag",new t(h,0)],["else"],["setTag",new t(h,1)],["end"],["end"]],s.prototype.commands.onMouseUp=[["temp","b",new t(u,"this.mode")],["if"],["eq",new t(p,"b"),new t(h,0)],["set",new t(u,"this.layers.0.hidden"),new t(h,0)],["set",new t(u,"this.layers.1.hidden"),new t(h,1)],["setTag",new t(h,12)],["end"]],s.prototype.commands.onTagChange=[["temp","a",new t(h,0)],["temp","b",new t(u,"this.mode")],["getTag","a"],["if"],["eq",new t(p,"b"),new t(h,1)],["if"],["gt",new t(p,"a"),new t(h,0)],["set",new t(u,"this.layers.0.hidden"),new t(h,1)],["set",new t(u,"this.layers.1.hidden"),new t(h,0)],["else"],["set",new t(u,"this.layers.0.hidden"),new t(h,0)],["set",new t(u,"this.layers.1.hidden"),new t(h,1)],["end"],["end"]],a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.commands.onInitialize=[],a.prototype.commands.onMouseDown=[["temp","b",new t(u,"this.mode")],["if"],["eq",new t(p,"b"),new t(h,0)],["set",new t(u,"this.layers.0.hidden"),new t(h,1)],["set",new t(u,"this.layers.1.hidden"),new t(h,0)],["setTag",new t(h,0)],["else"],["temp","c",new t(h,0)],["getTag","c"],["if"],["gt",new t(p,"c"),new t(h,0)],["setTag",new t(h,0)],["else"],["setTag",new t(h,1)],["end"],["end"]],a.prototype.commands.onMouseUp=[["temp","b",new t(u,"this.mode")],["if"],["eq",new t(p,"b"),new t(h,0)],["set",new t(u,"this.layers.0.hidden"),new t(h,0)],["set",new t(u,"this.layers.1.hidden"),new t(h,1)],["setTag",new t(h,12)],["end"]],a.prototype.commands.onTagChange=[["temp","a",new t(h,0)],["temp","b",new t(h,0)],["temp","c",new t(h,0)],["set",new t(p,"a"),new t(u,"this.layers.length")],["set",new t(p,"c"),new t(p,"a")],["divide","c",new t(h,2)],["while"],["gt",new t(p,"a"),new t(h,0)],["minus","a",new t(h,1)],["print",new t(p,"a")],["set",new t(u,"this.layers.a.hidden"),new t(h,1)],["minus","a",new t(h,1)],["set",new t(u,"this.layers.a.hidden"),new t(h,0)],["end"],["getTag","a"],["print",new t(p,"a")],["if"],["gte",new t(p,"a"),new t(h,0)],["if"],["gt",new t(p,"c"),new t(p,"a")],["multiply","a",new t(h,2)],["set",new t(u,"this.layers.a.hidden"),new t(h,1)],["add","a",new t(h,1)],["set",new t(u,"this.layers.a.hidden"),new t(h,0)],["end"],["end"]];var d={},l={};d.transCommand=function(e,t){var s,a,r,i=t[0];switch(i){case"temp":a=t[1],r=n.execute(e,t[2]),l[a]=r,s="var "+a+"="+r+";\n";break;case"set":a=t[1],r=n.execute(e,t[2]),a in l&&(l[a]=r),s=a+"="+r+";\n";break;case"if":s="if";break;case"pred":var o=t[2],w=t[3];o in l||(o=n.execute(e,o)),w in l||(w=n.execute(e,w)),s="("+o+t[1]+w+"){\n";break;case"else":s="}else{\n";break;case"end":s="}\n";break;case"setTag":s='WidgetExecutor.setTag("'+e.tag+'",'+t[1]+")"}return s},d.transFunction=function(e,n){l={};for(var t="",s=0;s<n.length;s++)t+=this.transCommand(e,n[s]);return t},d.complier={},function(e){"use strict";function n(e){for(var t=[],s=!0;e.length&&s;){var a,r=e[0];switch(r[0]){case"if":a={},a.type="IF",a.args=[],e.shift(),a.args.push(e.shift()),a.args.push(n(e)),"else"===e[0][0]&&(e.shift(),a.args.push(n(e))),e.shift(),t.push(a);break;case"while":a={type:"WHILE",args:[]},e.shift(),a.args.push(e.shift()),a.args.push(n(e)),e.shift(),t.push(a);break;case"else":case"end":s=!1;break;default:t.push({type:"EXP",args:[r]}),e.shift()}}return t}function t(e,n){this.label=String(e),this.cmd=n}function s(e,n){p=0;var t=r(e,n);return a(t),t}function a(e){for(var n,t={},s=0;s<e.length;s++)n=e[s],""!==n.label&&(t[n.label]=s);for(s=0;s<e.length;s++){n=e[s];var a=n.cmd;if("jump"===a[0]){var r=t[a[2]];a[2]=r-s}}}function r(e,n){for(var s=[],a=0;a<e.length;a++){var r=e[a];switch(r.type){case"EXP":s.push(new t("",r.args[0]));break;case"IF":[].push.apply(s,i(r,n));break;case"WHILE":[].push.apply(s,o(r,n));break;default:s.push(new t("",r.args[0]))}}return s}function i(e,n){var s=[],a=e.args;2===a.length&&a.push([]);var i=a[0],o=a[2],w=a[1];if(n=n||!1){var h=i[0],g=u[h];g&&(i[0]=g,o=a[1],w=a[2])}s.push(new t("",i));var y=p;p+=1,s.push(new t("",[d,c,y])),[].push.apply(s,r(w,n));var f=p;p+=1,s.push(new t("",[d,c,f]));var m=r(o,n);return m.length>0?m[0].label=String(y):m.push(new t(y,[l,"",""])),[].push.apply(s,m),s.push(new t(f,[l,"",""])),s}function o(e,n){var s=[],a=e.args,i=a[0],o=a[1],w=p++,h=p++,g=p++;if(n){var y=u[i[0]];y?(i[0]=y,s.push(new t(w,i)),s.push(new t("",[d,c,h])),s.push(new t("",[d,c,g]))):(s.push(new t(w,i)),s.push(new t("",[d,c,g])),s.push(new t("",[d,c,h])))}var f=r(o,n);return f.push(new t("",[d,c,w])),f[0].label=String(h),[].push.apply(s,f),s.push(new t(g,[l,"",""])),s}var w={};w.parse=n;var h={},p=0,u={gte:"lt",lte:"gt"};h.trans=s;var d="jump",l="end",c="";e.parser=w,e.transformer=h}(d.complier);var c={};return c.models={},c.models.Button=s,c.models.ButtonGroup=a,c.Widget=n,c.WidgetCommandParser=d,c});