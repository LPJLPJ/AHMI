!function(e){if("function"==typeof define&&define.amd)define("WidgetModel",["./layer"],e);else if("object"==typeof module&&module.exports){console.log(__dirpath);var t=require("./layer");module.exports=e(t)}else window.WidgetModel=e(window.LayerModel)}(function(e){function t(e,t,s,r,a){this.info={left:e,top:t,width:s,height:r},this.tag="defaultTag",this.type="general",a&&a.length?this.layers=a:this.layers=[new n(s,r)]}function s(e,t){this.type=e,this.value=t}function r(e,s,r,u,h,p,l){var c=new n(r,u);c.subLayers.font=new a(0,0,r,u,h,p),c.subLayers.texture=new i(0,0,r,u,l[0].imgSrc),c.subLayers.color=new o(0,0,r,u,l[0].color);var f=new n(r,u);f.subLayers.font=new a(0,0,r,u,h,p),f.subLayers.texture=new i(0,0,r,u,l[1].imgSrc),f.subLayers.color=new o(0,0,r,u,l[1].color);var g=[c,f];this.subType="Button",t.call(this,e,s,r,u,g)}var n=e.Layer,a=(e.ROISubLayer,e.FontSubLayer),i=e.TextureSubLayer,o=e.ColorSubLayer;t.prototype.toObject=function(){return{info:{left:this.info.left,top:this.info.top,width:this.info.width,height:this.info.height},tag:this.tag,layers:this.layers}},t.execute=function(e,t,s){return"__tag"==t?this.getTag(e.tag):"string"==typeof t?'"'+t+'"':t};var u="Int",h="ID",p="EXP";r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype.commands={},r.prototype.commands.onInitialize=[["temp","a",new s(u,12)],["setTag",new s(u,1)],["if"],["gte",new s(h,"a"),new s(u,100)],["set",new s(p,"this.layers.1.hidden"),new s(u,1)],["else"],["set",new s(p,"this.layers.1.hidden"),new s(u,0)],["end"]],r.prototype.commands.onMouseDown=[["set","this.layers[1].hidden",!1],["set","this.layers[0].hidden",!0],["setTag",101]],r.prototype.commands.onMouseUp=[["set","this.layers[1].hidden",!0],["set","this.layers[0].hidden",!1],["setTag",12]];var l={},c={};l.transCommand=function(e,s){var r,n,a,i=s[0];switch(i){case"temp":n=s[1],a=t.execute(e,s[2]),c[n]=a,r="var "+n+"="+a+";\n";break;case"set":n=s[1],a=t.execute(e,s[2]),n in c&&(c[n]=a),r=n+"="+a+";\n";break;case"if":r="if";break;case"pred":var o=s[2],u=s[3];o in c||(o=t.execute(e,o)),u in c||(u=t.execute(e,u)),r="("+o+s[1]+u+"){\n";break;case"else":r="}else{\n";break;case"end":r="}\n";break;case"setTag":r='WidgetExecutor.setTag("'+e.tag+'",'+s[1]+")"}return r},l.transFunction=function(e,t){c={};for(var s="",r=0;r<t.length;r++)s+=this.transCommand(e,t[r]);return s},l.complier={},function(e){"use strict";function t(e){for(var s=[],r=!0;e.length&&r;){var n,a=e[0];switch(a[0]){case"if":n={},n.type="IF",n.args=[],e.shift(),n.args.push(e.shift()),n.args.push(t(e)),"else"===e[0][0]&&(e.shift(),n.args.push(t(e))),e.shift(),s.push(n);break;case"while":n={type:"WHILE",args:[]},e.shift(),n.args.push(e.shift()),n.args.push(t(e)),e.shift(),s.push(n);break;case"else":case"end":r=!1;break;default:s.push({type:"EXP",args:[a]}),e.shift()}}return s}function s(e,t){this.label=String(e),this.cmd=t}function r(e,t){var s=a(e,t);return n(s),s}function n(e){for(var t,s={},r=0;r<e.length;r++)t=e[r],""!==t.label&&(s[t.label]=r);for(r=0;r<e.length;r++){t=e[r];var n=t.cmd;if("jump"===n[0]){var a=s[n[2]];n[2]=a-r}}}function a(e,t){for(var r=[],n=0;n<e.length;n++){var a=e[n];switch(a.type){case"EXP":r.push(new s("",a.args[0]));break;case"IF":[].push.apply(r,i(a,t));break;case"WHILE":[].push.apply(r,o(a,t));break;default:r.push(new s("",a.args[0]))}}return r}function i(e,t){var r=[],n=e.args;2===n.length&&n.push([]);var i=n[0],o=n[2],u=n[1];if(t=t||!1){var h=i[0],d=l[h];d&&(i[0]=d,o=n[1],u=n[2])}r.push(new s("",i));var y=p;p+=1,r.push(new s("",[c,g,y])),[].push.apply(r,a(u,t));var w=p;p+=1,r.push(new s("",[c,g,w]));var v=a(o,t);return v.length>0?v[0].label=String(y):v.push(new s(y,[f,"",""])),[].push.apply(r,v),r.push(new s(w,[f,"",""])),r}function o(e,t){var r=[],n=e.args,i=n[0],o=n[1],u=p++,h=p++,d=p++;if(t){var y=l[i[0]];y?(i[0]=y,r.push(new s(u,i)),r.push(new s("",[c,g,h])),r.push(new s("",[c,g,d]))):(r.push(new s(u,i)),r.push(new s("",[c,g,d])),r.push(new s("",[c,g,h])))}var w=a(o,t);return w.push(new s("",[c,g,u])),w[0].label=String(h),[].push.apply(r,w),r.push(new s(d,[f,"",""])),r}var u={};u.parse=t;var h={},p=0,l={gte:"lt",lte:"gt"};h.trans=r;var c="jump",f="end",g="";e.parser=u,e.transformer=h}(l.complier);var f={};return f.models={},f.models.Button=r,f.Widget=t,f.WidgetCommandParser=l,f});