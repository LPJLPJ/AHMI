!function(e){if("function"==typeof define&&define.amd)define("WidgetModel",["./layer"],e);else if("object"==typeof module&&module.exports){console.log(__dirpath);var t=require("./layer");module.exports=e(t)}else window.WidgetModel=e(window.LayerModel)}(function(e){function t(e,t,s,a,n){this.info={left:e,top:t,width:s,height:a},this.tag="defaultTag",this.type="general",n&&n.length?this.layers=n:this.layers=[new r(s,a)]}function s(e,s,o,u,h,p,l){var c=new r(o,u);c.subLayers.font=new a(0,0,o,u,h,p),c.subLayers.texture=new n(0,0,o,u,l[0].imgSrc),c.subLayers.color=new i(0,0,o,u,l[0].color);var f=new r(o,u);f.subLayers.font=new a(0,0,o,u,h,p),f.subLayers.texture=new n(0,0,o,u,l[1].imgSrc),f.subLayers.color=new i(0,0,o,u,l[1].color);var g=[c,f];this.subType="Button",t.call(this,e,s,o,u,g)}var r=e.Layer,a=(e.ROISubLayer,e.FontSubLayer),n=e.TextureSubLayer,i=e.ColorSubLayer;t.prototype.toObject=function(){return{info:{left:this.info.left,top:this.info.top,width:this.info.width,height:this.info.height},tag:this.tag,layers:this.layers}},t.execute=function(e,t,s){return"__tag"==t?this.getTag(e.tag):"string"==typeof t?'"'+t+'"':t},s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.prototype.commands={},s.prototype.commands.onInitialize=[["setTag",1],["if"],["gte","a",100],["set","this.layers[1].hidden",!0],["else"],["set","this.layers[1].hidden",!1],["end"]],s.prototype.commands.onMouseDown=[["set","this.layers[1].hidden",!1],["set","this.layers[0].hidden",!0],["setTag",101]],s.prototype.commands.onMouseUp=[["set","this.layers[1].hidden",!0],["set","this.layers[0].hidden",!1],["setTag",12]];var o={},u={};o.transCommand=function(e,s){var r,a,n,i=s[0];switch(i){case"temp":a=s[1],n=t.execute(e,s[2]),u[a]=n,r="var "+a+"="+n+";\n";break;case"set":a=s[1],n=t.execute(e,s[2]),a in u&&(u[a]=n),r=a+"="+n+";\n";break;case"if":r="if";break;case"pred":var o=s[2],h=s[3];o in u||(o=t.execute(e,o)),h in u||(h=t.execute(e,h)),r="("+o+s[1]+h+"){\n";break;case"else":r="}else{\n";break;case"end":r="}\n";break;case"setTag":r='WidgetExecutor.setTag("'+e.tag+'",'+s[1]+")"}return r},o.transFunction=function(e,t){u={};for(var s="",r=0;r<t.length;r++)s+=this.transCommand(e,t[r]);return s},o.complier={},function(e){"use strict";function t(e){for(var s=[],r=!0;e.length&&r;){var a,n=e[0];switch(n[0]){case"if":a={},a.type="IF",a.args=[],e.shift(),a.args.push(e.shift()),a.args.push(t(e)),"else"===e[0][0]&&(e.shift(),a.args.push(t(e))),e.shift(),s.push(a);break;case"while":a={type:"WHILE",args:[]},e.shift(),a.args.push(e.shift()),a.args.push(t(e)),e.shift(),s.push(a);break;case"else":case"end":r=!1;break;default:s.push({type:"EXP",args:[n]}),e.shift()}}return s}function s(e,t){this.label=String(e),this.cmd=t}function r(e,t){var s=n(e,t);return a(s),s}function a(e){for(var t,s={},r=0;r<e.length;r++)t=e[r],""!==t.label&&(s[t.label]=r);for(r=0;r<e.length;r++){t=e[r];var a=t.cmd;if("jump"===a[0]){var n=s[a[2]];a[2]=n-r}}}function n(e,t){for(var r=[],a=0;a<e.length;a++){var n=e[a];switch(n.type){case"EXP":r.push(new s("",n.args[0]));break;case"IF":[].push.apply(r,i(n,t));break;case"WHILE":[].push.apply(r,o(n,t));break;default:r.push(new s("",n.args[0]))}}return r}function i(e,t){var r=[],a=e.args;2===a.length&&a.push([]);var i=a[0],o=a[2],u=a[1];if(t=t||!1){var h=i[0],d=l[h];d&&(i[0]=d,o=a[1],u=a[2])}r.push(new s("",i));var y=p;p+=1,r.push(new s("",[c,g,y])),[].push.apply(r,n(u,t));var w=p;p+=1,r.push(new s("",[c,g,w]));var b=n(o,t);return b.length>0?b[0].label=String(y):b.push(new s(y,[f,"",""])),[].push.apply(r,b),r.push(new s(w,[f,"",""])),r}function o(e,t){var r=[],a=e.args,i=a[0],o=a[1],u=p++,h=p++,d=p++;if(t){var y=l[i[0]];y?(i[0]=y,r.push(new s(u,i)),r.push(new s("",[c,g,h])),r.push(new s("",[c,g,d]))):(r.push(new s(u,i)),r.push(new s("",[c,g,d])),r.push(new s("",[c,g,h])))}var w=n(o,t);return w.push(new s("",[c,g,u])),w[0].label=String(h),[].push.apply(r,w),r.push(new s(d,[f,"",""])),r}var u={};u.parse=t;var h={},p=0,l={gte:"lt",lte:"gt"};h.trans=r;var c="jump",f="end",g="";e.parser=u,e.transformer=h}(o.complier);var h={};return h.models={},h.models.Button=s,h.Widget=t,h.WidgetCommandParser=o,h});