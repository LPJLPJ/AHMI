!function(e){if("function"==typeof define&&define.amd)define("WidgetModel",["./layer"],e);else if("object"==typeof module&&module.exports){console.log(__dirpath);var t=require("./layer");module.exports=e(t)}else window.WidgetModel=e(window.LayerModel)}(function(e){function t(e,t,n,s,r){this.info={left:e,top:t,width:n,height:s},this.tag="defaultTag",this.type="general",this.mode=0,this.otherAttrs=[],r&&r.length?this.layers=r:this.layers=[new l(n,s)]}function n(e,t){this.type=e,this.value=t}function s(e){var t=[],n={r:0,g:0,b:0,a:0};if(-1!==e.indexOf("rgba"))t=e.split(/[\(|\)]/)[1].split(",").map(function(e){return Number(e)}),n={r:t[0],g:t[1],b:t[2],a:255*t[3]};else{if(-1===e.indexOf("rgb"))throw new Error("parsing color error: "+e);t=e.split(/[\(|\)]/)[1].split(","),n={r:t[0],g:t[1],b:t[2],a:255}}return n}function r(e,n,r,o,a,i,w){var p,c=new l(0,0,r,o);c.subLayers.font=new h(a,i),c.subLayers.image=new y(w[0].imgSrc),p=s(w[0].color),c.subLayers.color=new g(p);var u=new l(0,0,r,o);u.subLayers.font=new h(a,i),u.subLayers.image=new y(w[1].imgSrc),p=s(w[1].color),u.subLayers.color=new g(p);var m=[c,u];this.subType="Button",t.call(this,e,n,r,o,m)}function o(e,n,r,o,a,i,w,p){var c,u=0,h=0,m=[];if(0==i){u=(r-(a-1)*w)/a,h=o;for(var d=0;d<a;d++){var b=new l(d*(u+w),0,u,h);b.subLayers.image=new y(p[2*d].imgSrc),c=s(p[2*d].color),b.subLayers.color=new g(c);var f=new l(d*(u+w),0,u,h,!0);f.subLayers.image=new y(p[2*d+1].imgSrc),c=s(p[2*d+1].color),f.subLayers.color=new g(c),m.push(b),m.push(f)}}this.subType="ButtonGroup",t.call(this,e,n,r,o,m)}function a(e,n,r,o,a,i,w){w=w||{};var p,c,h,m,d=[];if(0==a){p=[i[0].slices[0],i[1].slices[0]],c=new l(0,0,r,o),c.subLayers.image=new y(p[0].imgSrc),c.subLayers.color=new g(s(p[0].color));var b=w.pointerLength/Math.sqrt(2);h=new l(r/2,o/2,b,b),h.subLayers.image=new y(p[1].imgSrc),h.subLayers.color=new g(s(p[1].color)),d.push(c),d.push(h)}else if(1==a){p=[i[0].slices[0],i[1].slices[0],i[2].slices[0]],c=new l(0,0,r,o),c.subLayers.image=new y(p[0].imgSrc),c.subLayers.color=new g(s(p[0].color)),m=new l(0,0,r,o),m.subLayers.image=new y(p[2].imgSrc),m.subLayers.color=new g(s(p[2].color)),m.subLayers.roi=new u(1);var b=w.pointerLength/Math.sqrt(2);h=new l(r/2,o/2,b,b),h.subLayers.image=new y(p[1].imgSrc),h.subLayers.color=new g(s(p[1].color)),d.push(c),d.push(h),d.push(m)}else 2==a&&(p=[i[0].slices[0]],m=new l(0,0,r,o),m.subLayers.image=new y(p[0].imgSrc),m.subLayers.color=new g(s(p[0].color)),m.subLayers.roi=new u(1),d.push(m));t.call(this,e,n,r,o,d)}function i(e,n,r,o,a){var i,w=[];i=new l(0,0,r,o),i.subLayers.image=new y(a.imgSrc),i.subLayers.color=new g(s(a.color)),w.push(i),t.call(this,e,n,r,o,w)}function w(e,n,r,o,a,i,w){var p,c=[];p=new l(0,0,r,o),p.subLayers.font=new h(a,i),p.subLayers.image=new y(w.imgSrc),p.subLayers.color=new g(s(w.color)),c.push(p),t.call(this,e,n,r,o,c)}function p(e,n,s,r){var o=[];t.call(this,e,n,s,r,o)}function c(e,n,r,o,a,i){var w,p=new l(0,0,r,o),c=new l(0,0,r,o),h=new l(0,0,r,o),m=Number(a.progressModeId),d=Number(a.cursor),b=i.length;w=s(i[0].color),p.subLayers.color=new g(w),p.subLayers.image=new y(i[0].imgSrc),0==m?(w=s(i[1].color),c.subLayers.color=new g(w),c.subLayers.image=new y(i[1].imgSrc),c.subLayers.roi=new u(0)):1==m?(w=s(i[1].color),c.subLayers.color=new g(w)):3==m&&(w=s(i[1].color),c.subLayers.color=new g(w)),1==d&&(h.subLayers.image=new y(i[b-1].imgSrc));var f=[p,c,h];this.subType="Progress",t.call(this,e,n,r,o,f)}var l=e.Layer,u=e.ROISubLayer,h=e.FontSubLayer,y=e.TextureSubLayer,g=e.ColorSubLayer;t.prototype.toObject=function(){return{info:{left:this.info.left,top:this.info.top,width:this.info.width,height:this.info.height},mode:this.mode,tag:this.tag,layers:this.layers,otherAttrs:this.otherAttrs}},t.prototype.commands={},t.execute=function(e,t,n){return"__tag"==t?this.getTag(e.tag):"string"==typeof t?'"'+t+'"':t};var m="Int",d="ID",b="EXP";r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype.commands={},r.prototype.commands.onInitialize=[["temp","a",new n(b,"this.mode")],["setTag",new n(m,1)],["set",new n(d,"a"),new n(m,3)],["if"],["gte",new n(d,"a"),new n(m,100)],["set",new n(b,"this.layers.1.hidden"),new n(m,1)],["else"],["set",new n(b,"this.layers.1.hidden"),new n(m,0)],["end"]],r.prototype.commands.onMouseDown=[["temp","b",new n(b,"this.mode")],["print",new n(d,"b")],["if"],["eq",new n(d,"b"),new n(m,0)],["set",new n(b,"this.layers.0.hidden"),new n(m,1)],["set",new n(b,"this.layers.1.hidden"),new n(m,0)],["setTag",new n(m,0)],["else"],["temp","c",new n(m,0)],["getTag","c"],["if"],["gt",new n(d,"c"),new n(m,0)],["setTag",new n(m,0)],["else"],["setTag",new n(m,1)],["end"],["end"]],r.prototype.commands.onMouseUp=[["temp","b",new n(b,"this.mode")],["if"],["eq",new n(d,"b"),new n(m,0)],["set",new n(b,"this.layers.0.hidden"),new n(m,0)],["set",new n(b,"this.layers.1.hidden"),new n(m,1)],["setTag",new n(m,12)],["end"]],r.prototype.commands.onTagChange=[["temp","a",new n(m,0)],["temp","b",new n(b,"this.mode")],["getTag","a"],["if"],["eq",new n(d,"b"),new n(m,1)],["if"],["gt",new n(d,"a"),new n(m,0)],["set",new n(b,"this.layers.0.hidden"),new n(m,1)],["set",new n(b,"this.layers.1.hidden"),new n(m,0)],["else"],["set",new n(b,"this.layers.0.hidden"),new n(m,0)],["set",new n(b,"this.layers.1.hidden"),new n(m,1)],["end"],["end"]],o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype.commands.onInitialize=[],o.prototype.commands.onMouseDown=[["temp","a",new n(m,0)],["temp","b",new n(m,0)],["temp","c",new n(m,0)],["set",new n(d,"c"),new n(b,"this.layers.length")],["minus","c",new n(m,2)],["set",new n(d,"a"),new n(b,"this.innerX")],["set",new n(d,"b"),new n(b,"this.innerY")],["temp","lx",new n(m,0)],["temp","ly",new n(m,0)],["temp","lw",new n(m,0)],["temp","lh",new n(m,0)],["temp","rx",new n(m,0)],["temp","ry",new n(m,0)],["while"],["gte",new n(d,"c"),new n(m,0)],["set",new n(d,"lx"),new n(b,"this.layers.c.x")],["set",new n(d,"ly"),new n(b,"this.layers.c.y")],["set",new n(d,"lw"),new n(b,"this.layers.c.width")],["set",new n(d,"lh"),new n(b,"this.layers.c.height")],["set",new n(d,"rx"),new n(d,"lx")],["set",new n(d,"ry"),new n(d,"ly")],["add","rx",new n(d,"lw")],["add","ry",new n(d,"lh")],["if"],["gte",new n(d,"a"),new n(d,"lx")],["if"],["gt",new n(d,"rx"),new n(d,"a")],["if"],["gte",new n(d,"b"),new n(d,"ly")],["if"],["gt",new n(d,"ry"),new n(d,"b")],["print",new n(d,"c"),"hit"],["divide","c",new n(m,2)],["setTag",new n(d,"c")],["set",new n(d,"c"),new n(m,0)],["end"],["end"],["end"],["end"],["minus","c",new n(m,2)],["end"]],o.prototype.commands.onMouseUp=[],o.prototype.commands.onTagChange=[["temp","a",new n(m,0)],["temp","b",new n(m,0)],["temp","c",new n(m,0)],["set",new n(d,"a"),new n(b,"this.layers.length")],["set",new n(d,"c"),new n(d,"a")],["divide","c",new n(m,2)],["while"],["gt",new n(d,"a"),new n(m,0)],["minus","a",new n(m,1)],["print",new n(d,"a")],["set",new n(b,"this.layers.a.hidden"),new n(m,1)],["minus","a",new n(m,1)],["set",new n(b,"this.layers.a.hidden"),new n(m,0)],["end"],["getTag","a"],["print",new n(d,"a")],["if"],["gte",new n(d,"a"),new n(m,0)],["if"],["gt",new n(d,"c"),new n(d,"a")],["multiply","a",new n(m,2)],["set",new n(b,"this.layers.a.hidden"),new n(m,1)],["add","a",new n(m,1)],["set",new n(b,"this.layers.a.hidden"),new n(m,0)],["end"],["end"]],a.prototype=Object.create(t.prototype),a.prototype.constructor=a,i.prototype=Object.create(t.prototype),i.prototype.constructor=i,w.prototype=Object.create(t.prototype),w.prototype.constructor=w,p.prototype=Object.create(t.prototype),p.prototype.constructor=p,c.prototype=Object.create(t.prototype),c.prototype.constructor=c,c.prototype.commands.onInitialize=[["temp","a",new n(m,0)]],c.prototype.commands.onMouseDown=[["temp","a",new n(m,0)]],c.prototype.commands.onMouseUp=[["temp","a",new n(m,0)]],c.prototype.commands.onTagChange=[["temp","a",new n(m,0)]];var f={},v={};f.transCommand=function(e,n){var s,r,o,a=n[0];switch(a){case"temp":r=n[1],o=t.execute(e,n[2]),v[r]=o,s="var "+r+"="+o+";\n";break;case"set":r=n[1],o=t.execute(e,n[2]),r in v&&(v[r]=o),s=r+"="+o+";\n";break;case"if":s="if";break;case"pred":var i=n[2],w=n[3];i in v||(i=t.execute(e,i)),w in v||(w=t.execute(e,w)),s="("+i+n[1]+w+"){\n";break;case"else":s="}else{\n";break;case"end":s="}\n";break;case"setTag":s='WidgetExecutor.setTag("'+e.tag+'",'+n[1]+")"}return s},f.transFunction=function(e,t){v={};for(var n="",s=0;s<t.length;s++)n+=this.transCommand(e,t[s]);return n},f.complier={},function(e){"use strict";function t(e){for(var n=[],s=!0;e.length&&s;){var r,o=e[0];switch(o[0]){case"if":r={},r.type="IF",r.args=[],e.shift(),r.args.push(e.shift()),r.args.push(t(e)),"else"===e[0][0]&&(e.shift(),r.args.push(t(e))),e.shift(),n.push(r);break;case"while":r={type:"WHILE",args:[]},e.shift(),r.args.push(e.shift()),r.args.push(t(e)),e.shift(),n.push(r);break;case"else":case"end":s=!1;break;default:n.push({type:"EXP",args:[o]}),e.shift()}}return n}function n(e,t){this.label=String(e),this.cmd=t}function s(e,t){c=0;var n=o(e,t);return r(n),n}function r(e){for(var t,n={},s=0;s<e.length;s++)t=e[s],""!==t.label&&(n[t.label]=s);for(s=0;s<e.length;s++){t=e[s];var r=t.cmd;if("jump"===r[0]){var o=n[r[2]];r[2]=o-s}}}function o(e,t){for(var s=[],r=0;r<e.length;r++){var o=e[r];switch(o.type){case"EXP":s.push(new n("",o.args[0]));break;case"IF":[].push.apply(s,a(o,t));break;case"WHILE":[].push.apply(s,i(o,t));break;default:s.push(new n("",o.args[0]))}}return s}function a(e,t){var s=[],r=e.args;2===r.length&&r.push([]);var a=r[0],i=r[2],w=r[1];if(t=t||!1){var p=a[0],g=l[p];g&&(a[0]=g,i=r[1],w=r[2])}s.push(new n("",a));var m=c;c+=1,s.push(new n("",[u,y,m])),[].push.apply(s,o(w,t));var d=c;c+=1,s.push(new n("",[u,y,d]));var b=o(i,t);return b.length>0?b[0].label=String(m):b.push(new n(m,[h,"",""])),[].push.apply(s,b),s.push(new n(d,[h,"",""])),s}function i(e,t){var s=[],r=e.args,a=r[0],i=r[1],w=c++,p=c++,g=c++;if(t){var m=l[a[0]];m?(a[0]=m,s.push(new n(w,a)),s.push(new n("",[u,y,p])),s.push(new n("",[u,y,g]))):(s.push(new n(w,a)),s.push(new n("",[u,y,g])),s.push(new n("",[u,y,p])))}var d=o(i,t);return d.push(new n("",[u,y,w])),d[0].label=String(p),[].push.apply(s,d),s.push(new n(g,[h,"",""])),s}var w={};w.parse=t;var p={},c=0,l={gte:"lt",lte:"gt"};p.trans=s;var u="jump",h="end",y="";e.parser=w,e.transformer=p}(f.complier);var L={};return L.models={},L.models.Button=r,L.models.ButtonGroup=o,L.models.Dashboard=a,L.models.RotateImg=i,L.models.TextArea=w,L.models.Progress=c,L.models.ScriptTrigger=p,L.Widget=t,L.WidgetCommandParser=f,L});