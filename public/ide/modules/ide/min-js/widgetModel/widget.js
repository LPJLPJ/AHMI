!function(e){if("function"==typeof define&&define.amd)define("WidgetModel",["./layer"],e);else if("object"==typeof module&&module.exports){console.log(__dirpath);var t=require("./layer");module.exports=e(t)}else window.WidgetModel=e(window.LayerModel)}(function(e){function t(e,t,n,s,r){this.info={left:e,top:t,width:n,height:s},this.tag="defaultTag",this.type="general",this.mode=0,r&&r.length?this.layers=r:this.layers=[new a(n,s)]}function n(e,t){this.type=e,this.value=t}function s(e,n,s,h,u,p,w){var l=new a(s,h);l.subLayers.font=new r(0,0,s,h,u,p),l.subLayers.texture=new i(0,0,s,h,w[0].imgSrc),l.subLayers.color=new o(0,0,s,h,w[0].color);var d=new a(s,h);d.subLayers.font=new r(0,0,s,h,u,p),d.subLayers.texture=new i(0,0,s,h,w[1].imgSrc),d.subLayers.color=new o(0,0,s,h,w[1].color);var c=[l,d];this.subType="Button",t.call(this,e,n,s,h,c)}var a=e.Layer,r=(e.ROISubLayer,e.FontSubLayer),i=e.TextureSubLayer,o=e.ColorSubLayer;t.prototype.toObject=function(){return{info:{left:this.info.left,top:this.info.top,width:this.info.width,height:this.info.height},mode:this.mode,tag:this.tag,layers:this.layers}},t.prototype.commands={},t.execute=function(e,t,n){return"__tag"==t?this.getTag(e.tag):"string"==typeof t?'"'+t+'"':t};var h="Int",u="ID",p="EXP";s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.prototype.commands={},s.prototype.commands.onInitialize=[["temp","a",new n(p,"this.mode")],["setTag",new n(h,1)],["set",new n(u,"a"),new n(h,3)],["if"],["gte",new n(u,"a"),new n(h,100)],["set",new n(p,"this.layers.1.hidden"),new n(h,1)],["else"],["set",new n(p,"this.layers.1.hidden"),new n(h,0)],["end"]],s.prototype.commands.onMouseDown=[["temp","b",new n(p,"this.mode")],["if"],["eq",new n(u,"b"),new n(h,0)],["set",new n(p,"this.layers.0.hidden"),new n(h,1)],["set",new n(p,"this.layers.1.hidden"),new n(h,0)],["setTag",new n(h,0)],["else"],["temp","c",new n(h,0)],["getTag","c"],["if"],["gt",new n(u,"c"),new n(h,0)],["setTag",new n(h,0)],["else"],["setTag",new n(h,1)],["end"],["end"]],s.prototype.commands.onMouseUp=[["temp","b",new n(p,"this.mode")],["if"],["eq",new n(u,"b"),new n(h,0)],["set",new n(p,"this.layers.0.hidden"),new n(h,0)],["set",new n(p,"this.layers.1.hidden"),new n(h,1)],["setTag",new n(h,12)],["end"]],s.prototype.commands.onTagChange=[["temp","a",new n(h,0)],["temp","b",new n(p,"this.mode")],["getTag","a"],["if"],["eq",new n(u,"b"),new n(h,1)],["if"],["gt",new n(u,"a"),new n(h,0)],["set",new n(p,"this.layers.0.hidden"),new n(h,1)],["set",new n(p,"this.layers.1.hidden"),new n(h,0)],["else"],["set",new n(p,"this.layers.0.hidden"),new n(h,0)],["set",new n(p,"this.layers.1.hidden"),new n(h,1)],["end"],["end"]];var w={},l={};w.transCommand=function(e,n){var s,a,r,i=n[0];switch(i){case"temp":a=n[1],r=t.execute(e,n[2]),l[a]=r,s="var "+a+"="+r+";\n";break;case"set":a=n[1],r=t.execute(e,n[2]),a in l&&(l[a]=r),s=a+"="+r+";\n";break;case"if":s="if";break;case"pred":var o=n[2],h=n[3];o in l||(o=t.execute(e,o)),h in l||(h=t.execute(e,h)),s="("+o+n[1]+h+"){\n";break;case"else":s="}else{\n";break;case"end":s="}\n";break;case"setTag":s='WidgetExecutor.setTag("'+e.tag+'",'+n[1]+")"}return s},w.transFunction=function(e,t){l={};for(var n="",s=0;s<t.length;s++)n+=this.transCommand(e,t[s]);return n},w.complier={},function(e){"use strict";function t(e){for(var n=[],s=!0;e.length&&s;){var a,r=e[0];switch(r[0]){case"if":a={},a.type="IF",a.args=[],e.shift(),a.args.push(e.shift()),a.args.push(t(e)),"else"===e[0][0]&&(e.shift(),a.args.push(t(e))),e.shift(),n.push(a);break;case"while":a={type:"WHILE",args:[]},e.shift(),a.args.push(e.shift()),a.args.push(t(e)),e.shift(),n.push(a);break;case"else":case"end":s=!1;break;default:n.push({type:"EXP",args:[r]}),e.shift()}}return n}function n(e,t){this.label=String(e),this.cmd=t}function s(e,t){p=0;var n=r(e,t);return a(n),n}function a(e){for(var t,n={},s=0;s<e.length;s++)t=e[s],""!==t.label&&(n[t.label]=s);for(s=0;s<e.length;s++){t=e[s];var a=t.cmd;if("jump"===a[0]){var r=n[a[2]];a[2]=r-s}}}function r(e,t){for(var s=[],a=0;a<e.length;a++){var r=e[a];switch(r.type){case"EXP":s.push(new n("",r.args[0]));break;case"IF":[].push.apply(s,i(r,t));break;case"WHILE":[].push.apply(s,o(r,t));break;default:s.push(new n("",r.args[0]))}}return s}function i(e,t){var s=[],a=e.args;2===a.length&&a.push([]);var i=a[0],o=a[2],h=a[1];if(t=t||!1){var u=i[0],f=w[u];f&&(i[0]=f,o=a[1],h=a[2])}s.push(new n("",i));var g=p;p+=1,s.push(new n("",[l,c,g])),[].push.apply(s,r(h,t));var y=p;p+=1,s.push(new n("",[l,c,y]));var m=r(o,t);return m.length>0?m[0].label=String(g):m.push(new n(g,[d,"",""])),[].push.apply(s,m),s.push(new n(y,[d,"",""])),s}function o(e,t){var s=[],a=e.args,i=a[0],o=a[1],h=p++,u=p++,f=p++;if(t){var g=w[i[0]];g?(i[0]=g,s.push(new n(h,i)),s.push(new n("",[l,c,u])),s.push(new n("",[l,c,f]))):(s.push(new n(h,i)),s.push(new n("",[l,c,f])),s.push(new n("",[l,c,u])))}var y=r(o,t);return y.push(new n("",[l,c,h])),y[0].label=String(u),[].push.apply(s,y),s.push(new n(f,[d,"",""])),s}var h={};h.parse=t;var u={},p=0,w={gte:"lt",lte:"gt"};u.trans=s;var l="jump",d="end",c="";e.parser=h,e.transformer=u}(w.complier);var d={};return d.models={},d.models.Button=s,d.Widget=t,d.WidgetCommandParser=w,d});