ide.controller("ActionCtl",["$scope","ActionService","TagService","$uibModal","ProjectService","Type","OperationService",function(e,t,n,c,o,i,a){function s(){e.status={collapsed:!1},r(),e.tags=n.getAllCustomTags(),e.timerTags=n.getAllTimerTags(),e.collapse=function(t){e.status.collapsed=!e.status.collapsed},e.animationsEnabled=!0}function r(){if(o.getCurrentSelectObject()){var n=o.getCurrentSelectObject().level,c=_.cloneDeep(n.actions);t.setActions(c),e.actions=t.getAllActions(),e.triggers=t.getTriggers(o.getCurrentSelectObject().level.type);var a=_.cloneDeep(o.getCurrentSelectObject().level);if(a){switch(a.type){case i.MyButton:case i.MyNumber:case i.MySlide:case i.MyProgress:case i.MyDashboard:case i.MyButtonGroup:case i.MySubLayer:case i.MyPage:case i.MyNum:case i.MyImage:case i.MySwitch:case i.MyScriptTrigger:case i.MySlideBlock:e.showActionPanel=!0;break;default:e.showActionPanel=!1}switch(a.type){case i.MyPage:e.showAddActionPanel=!0;break;default:e.showAddActionPanel=!1}}}}function l(){e.$on("AttributeChanged",function(){r()}),e.deleteAction=function(n){t.deleteActionByIndex(n,function(){e.actions=t.getAllActions()}.bind(this))},e.openPanel=function(n){e.selectedIdx=n;var o;n==-1?o=t.getNewAction():n>=0&&n<e.actions.length&&(o=_.cloneDeep(e.actions[n]));var i=c.open({animation:e.animationsEnabled,templateUrl:"actionPanelModal.html",controller:"ActionInstanceCtrl",size:"lg",resolve:{action:function(){return o},triggers:function(){return e.triggers},tags:function(){return e.tags},timerTags:function(){return e.timerTags}}});i.result.then(function(n){e.selectedIdx==-1?t.appendAction(n,function(){e.actions=t.getAllActions()}.bind(this)):e.selectedIdx>=0&&e.selectedIdx<e.actions.length&&t.updateActionByIndex(n,e.selectedIdx,function(){e.actions=t.getAllActions()}.bind(this))},function(){})}}e.$on("GlobalProjectReceived",function(){s(),l(),e.$emit("LoadUp")})}]).controller("ActionInstanceCtrl",["$scope","$uibModalInstance","action","triggers","tags","timerTags","OperationService",function(e,t,n,c,o,i,a){var s=["",{tag:"",value:""},{tag:"",value:""}];e.ops=a.getOperations(),e.tags=_.map(o.filter(function(e){return"default"==e.bindMod}),"name"),e.timerTags=_.map(i,function(e){return e.name}),e.action=n,e.triggers=c,e.currentChosenIdx=e.action.commands.length-1,e.currentChosenIdx>0?e.chosenCmd=e.action.commands[e.currentChosenIdx]:e.chosenCmd=_.cloneDeep(s),e.chooseCmd=function(t){e.currentChosenIdx=t,e.chosenCmd=e.action.commands[t]},e.addNewCmd=function(){e.action.commands.splice(e.currentChosenIdx+1,0,_.cloneDeep(s)),e.currentChosenIdx+=1,e.chosenCmd=e.action.commands[e.currentChosenIdx]},e.deleteCmd=function(t){e.action.commands.splice(t,1),e.currentChosenIdx-=1},e.save=function(){t.close(e.action)},e.cancel=function(){t.dismiss("cancel")}}]);