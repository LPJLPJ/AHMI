ideServices.service("TagService",[function(){function e(e,t,n,i,s,r,u){this.name=e,this.register=t,this.indexOfRegister=n,this.writeOrRead=i,this.value=s,this.type=r||"custom",this.bindMod=u||"default"}function t(e){for(var t=f.map(function(e){return!1}),n=0;n<f.length;n++)for(var i=0;i<e.length;i++)if(e[i].name===f[n].name){t[n]=!0;break}for(n=0;n<t.length;n++)t[n]||e.push(f[n])}var n=new e("",!1,null,"true",null,"custom","default"),i=new e("传递按键编码",!1,null,"true",0,"system","forbidden"),s=new e("视频",!1,null,"true",0,"system","forbidden"),r=new e("当前页面序号",!1,null,"true",0,"system","forbidden"),u=new e("时钟变量年月日",!1,null,"true",0,"system"),a=new e("时钟变量时分秒",!1,null,"true",0,"system"),o=new e("背光",!1,null,"true",0,"system"),l=new e("蜂鸣器",!1,null,"true",0,"system"),f=[i,s,r,u,a,o,l],g=f,c=[],h=0,m=!0,d=!0;this.getNewTag=function(){return _.cloneDeep(n)},this.setUniqueTags=function(e,t,n){if(g.length+c.length>255)return void toastr.warning("超出tag数量限制");t(e,g)&&(g.push(e),n&&n())},this.syncAllTags=function(e){var n=[],i=[];if(e)for(var s=0;s<e.length;s++)0==e[s].name.indexOf("Sys")?i.push(e[s]):n.push(e[s]);t(n),g=n,c=i},this.syncCustomTags=function(e){t(e||[]),g=e},this.syncTimerTags=function(e){c=e||[]},this.getAllCustomTags=function(){return g},this.getAllTimerTags=function(){return c},this.getAllTags=function(){return g.concat(c)},this.getAllTagsName=function(){for(var e=g.concat(c),t=[],n=0;n<e.length;n++)t.push(e[n].name);return t},this.getTagByIndex=function(e){return g[e]},this.getTimerTagByIndex=function(e){return c[e]},this.deleteTagByIndex=function(e,t){e>=0&&e<=g.length-1&&(g.splice(e,1),t&&t())},this.editTagByIndex=function(e,t,n){if(0!=g.length){var i=_.clone(t);g.splice(e,1,i),n&&n()}},this.editTimerTagByIndex=function(e,t,n){if(0!=c.length){var i={};_.assignIn(i,t),c.splice(e,1,i),n&&n()}},this.setTimerTags=function(e){c.length=0;for(var t=0;t<e;t++)c[t]={name:"",register:!1,indexOfRegister:null,value:0},c[t].name="SysTmr_"+t+"_t"},this.setTimerNum=function(e){h=e},this.getTimerNum=function(){return h},this.sortByName=function(e){var t=function(e,t){var n=e.name,i=t.name;return m?n.localeCompare(i,"zh"):i.localeCompare(n,"zh")};m=!m,g.sort(t),e&&e()},this.sortByRegister=function(e){var t=function(e,t){var n=e.indexOfRegister||-1,i=t.indexOfRegister||-1;return d?n-i:i-n};d=!d,g.sort(t),e&&e()},this.setTagsFromRemote=function(e,t){Object.assign(g,e),t&&t()}}]);