ideServices.service("TagService",[function(){function e(e,t,n,i,s,r,u){this.name=e,this.register=t,this.indexOfRegister=n,this.writeOrRead=i,this.value=s,this.type=r||"custom",this.bindMod=u||"default"}function t(e){for(var t=o.map(function(e){return!1}),n=0;n<o.length;n++)for(var i=0;i<e.length;i++)if(e[i].name===o[n].name){t[n]=!0;break}for(n=0;n<t.length;n++)t[n]||e.push(o[n])}var n=new e("",(!1),null,"true",null,"custom","default"),i=new e("传递按键编码",(!1),null,"true",0,"system","forbidden"),s=new e("视频",(!1),null,"true",0,"system","forbidden"),r=new e("当前页面序号",(!1),null,"true",0,"system","forbidden"),u=new e("时钟变量年月日",(!1),null,"true",0,"system"),l=new e("时钟变量时分秒",(!1),null,"true",0,"system"),a=new e("背光",(!1),null,"true",0,"system"),g=new e("蜂鸣器",(!1),null,"true",0,"system"),o=[i,s,r,u,l,a,g],h=o,f=[],c=0;this.getNewTag=function(){return _.cloneDeep(n)},this.setUniqueTags=function(e,t,n){return h.length+f.length>255?void toastr.warning("超出tag数量限制"):void(t(e,h)&&(h.push(e),n&&n()))},this.syncAllTags=function(e){var n=[],i=[];if(e)for(var s=0;s<e.length;s++)0==e[s].name.indexOf("Sys")?i.push(e[s]):n.push(e[s]);t(n),h=n,f=i},this.syncCustomTags=function(e){t(e||[]),h=e},this.syncTimerTags=function(e){f=e||[]},this.getAllCustomTags=function(){return h},this.getAllTimerTags=function(){return f},this.getAllTimerTags_Cur=function(){},this.getAllTags=function(){return h.concat(f)},this.getAllTagsName=function(){for(var e=h.concat(f),t=[],n=0;n<e.length;n++)t.push(e[n].name);return t},this.getTagByIndex=function(e){return h[e]},this.getTimerTagByIndex=function(e){return f[e]},this.deleteTagByIndex=function(e,t){e>=0&&e<=h.length-1&&(h.splice(e,1),t&&t())},this.editTagByIndex=function(e,t,n){if(0!=h.length){var i=_.clone(t);h.splice(e,1,i),n&&n()}},this.editTimerTagByIndex=function(e,t,n){if(0!=f.length){var i={};_.assignIn(i,t),f.splice(e,1,i),n&&n()}},this.setTimerTags=function(e){f.length=0;for(var t=0;t<e;t++)f[t]={name:"",register:!1,indexOfRegister:null,value:0},f[t].name="SysTmr_"+t+"_t"},this.setTimerNum=function(e){c=e},this.getTimerNum=function(){return c}}]);