ide.controller("ImageSelectorInstanceCtl",["$scope","$timeout","$uibModalInstance","ProjectService","Type","ResourceService","widgetInfo","TexService",function(e,c,t,n,o,i,a,s){function r(c,t,n,o,i,a,s){e.canAddNewSlice=c,e.canInputText=t,e.sliceNum=n,e.tex=o,e.disableEditName=i,e.disableEditImg=a,e.disableEditColor=s}function l(){e.tempSlices=_.cloneDeep(e.tex.slices)}function u(e){e.name="selectSlice.color"}function d(){c(function(){e.tex.slices=_.cloneDeep(e.tempSlices)})}function m(){return"rgba("+_.random(64,255)+","+_.random(64,255)+","+_.random(64,255)+",1.0)"}switch(e.images=i.getAllImagesAndTemplates(),e.images.unshift({name:"---",src:""}),e.basicUrl=i.getResourceUrl(),e.$on("colorpicker-submit",function(e,c){u(c)}),e.$on("colorpicker-closed",function(e,c){d()}),e.$on("colorpicker-shown",function(e,c){l()}),e.canInputText=!1,e.canAddNewSlice=!1,e.disableEditImg=!1,e.disableEditColor=!1,e.sliceNum=0,a.type){case o.MyButton:r(!1,!1,2,a.tex,!0,!1,!1);break;case o.MyProgress:"1"!==a.objInfo.progressModeId&&"3"!==a.objInfo.progressModeId||1!=a.index&&2!=a.index&&3!=a.index?r(!1,!1,1,a.tex,!0,!1,!1):r(!1,!1,1,a.tex,!0,!0,!1),"光标纹理"===a.tex.name&&r(!1,!1,1,a.tex,!0,!1,!0);break;case o.MySlide:r(!0,!0,2,a.tex,!1,!1,!1);break;case o.MyNumber:r(!1,!1,13,a.tex,!1,!1,!1);break;case o.MyDashboard:r(!1,!1,2,a.tex,!0,!1,!1);break;case o.MyTextArea:r(!1,!1,1,a.tex,!0,!1,!1);break;case o.MyNum:r(!1,!1,1,a.tex,!1,!1,!1);break;case o.MyOscilloscope:case o.MyKnob:r(!1,!1,2,a.tex,!1,!1,!1);break;case o.MyImage:r(!1,!1,1,a.tex,!1,!1,!1);break;case o.MySwitch:case o.MyRotateImg:case o.MySlideBlock:r(!1,!1,1,a.tex,!0,!1,!1);break;case o.MyAnimation:r(!0,!1,1,a.tex,!1,!1,!1);break;case o.MyTexNum:case o.MyDateTime:case o.MyButtonGroup:r(!1,!1,1,a.tex,!0,!1,!1);break;case o.MyTexTime:r(!1,1,a.tex,!0);break;default:r(!0,!1,1,a.tex,!1,!1,!1)}e.addSlice=function(){e.tex.slices.splice(e.curIndex+1,0,s.getDefaultSlice())},e.removeSlice=function(c){1==e.tex.slices.length?toastr.warning("至少有一张纹理"):e.tex.slices.splice(c,1)},e.save=function(){b&&t.close(e.tex)},e.cancel=function(){t.dismiss("cancel")},e.disableColorInput=function(e,c){console.log(e,c),e.imgSrc?e.color="rgba(0,0,0,0)":e.color=m()},e.curIndex=0,e.selectItem=function(c){e.curIndex=c};var x,b=!0;e.store=function(e){x=e.slice.name},e.restore=function(e){e.slice.name=x},e.enterName=function(c){if(console.log("$scope.canInputText:",e.canInputText),c.slice.name!==x){if(!(b=n.inputValidate(c.slice.name)))return void e.restore(c);toastr.info("修改成功"),x=c.slice.name}},e.enterPress=function(c,t){13==c.keyCode&&e.enterName(t)}}]);