ide.controller("ImageSelectorInstanceCtl",["$scope","$timeout","$uibModalInstance","ProjectService","Type","ResourceService","widgetInfo","TexService",function(e,t,c,o,n,a,i,s){function r(t,c,o,n,a,i,s){e.canAddNewSlice=t,e.canInputText=c,e.sliceNum=o,e.tex=n,e.disableEditName=a,e.disableEditImg=i,e.disableEditColor=s}function l(){e.tempSlices=_.cloneDeep(e.tex.slices)}function x(e){e.name="selectSlice.color"}function d(){t(function(){e.tex.slices=_.cloneDeep(e.tempSlices)})}function u(){return"rgba("+_.random(64,255)+","+_.random(64,255)+","+_.random(64,255)+",1.0)"}switch(e.images=a.getAllImagesAndTemplates(),e.images.unshift({name:"---",src:""}),e.basicUrl=a.getResourceUrl(),e.$on("colorpicker-submit",function(e,t){x(t)}),e.$on("colorpicker-closed",function(e,t){d()}),e.$on("colorpicker-shown",function(e,t){l()}),e.canInputText=!1,e.canAddNewSlice=!1,e.disableEditImg=!1,e.disableEditColor=!1,e.sliceNum=0,i.type){case n.MyButton:r(!1,!1,2,i.tex,!0,!1,!1);break;case n.MyProgress:"1"!==i.objInfo.progressModeId&&"3"!==i.objInfo.progressModeId||1!=i.index&&2!=i.index&&3!=i.index?r(!1,!1,1,i.tex,!0,!1,!1):r(!1,!1,1,i.tex,!0,!0,!1),"光标纹理"===i.tex.name&&r(!1,!1,1,i.tex,!0,!1,!0);break;case n.MySlide:r(!0,!0,2,i.tex,!1,!1,!1);break;case n.MyNumber:r(!1,!1,13,i.tex,!1,!1,!1);break;case n.MyDashboard:r(!1,!1,2,i.tex,!0,!1,!1);break;case n.MyTextArea:r(!1,!1,1,i.tex,!0,!1,!1);break;case n.MyNum:r(!1,!1,1,i.tex,!1,!1,!1);break;case n.MyOscilloscope:case n.MyKnob:r(!1,!1,2,i.tex,!1,!1,!1);break;case n.MyImage:r(!1,!1,1,i.tex,!1,!1,!1);break;case n.MySwitch:case n.MyRotateImg:case n.MySlideBlock:r(!1,!1,1,i.tex,!0,!1,!1);break;case n.MyAnimation:r(!0,!1,1,i.tex,!1,!1,!1);break;case n.MyTexNum:case n.MyDateTime:case n.MyButtonGroup:case n.MyTexTime:r(!1,!1,1,i.tex,!0,!1,!1);break;case n.MySelector:"选择器背景"===i.tex.name&&r(!1,!1,1,i.tex,!0,!1,!1),"元素纹理"===i.tex.name&&(r(!1,!0,1,i.tex,!0,!1,!1),console.log("widgetInfo",i)),"元素选中后纹理"===i.tex.name&&r(!1,!0,1,i.tex,!0,!1,!1),"高亮"===i.tex.name&&r(!1,!1,1,i.tex,!0,!1,!1);break;case n.MyRotaryKnob:"高亮"===i.tex.name?r(!1,!1,1,i.tex,!0,!1,!1):r(!1,!1,1,i.tex,!0,!1,!0);break;case n.MyColorBlock:"高亮"===i.tex.name?r(!1,!1,1,i.tex,!0,!1,!1):r(!1,!1,1,i.tex,!0,!0,!1);break;default:r(!0,!1,1,i.tex,!1,!1,!1)}e.addSlice=function(){e.tex.slices.splice(e.curIndex+1,0,s.getDefaultSlice())},e.removeSlice=function(t){1==e.tex.slices.length?toastr.warning("至少有一张纹理"):e.tex.slices.splice(t,1)},e.save=function(){b&&c.close(e.tex)},e.cancel=function(){c.dismiss("cancel")},e.disableColorInput=function(e,t){e.imgSrc?(e._oldColor=e.color,e.color="rgba(0,0,0,0)"):e.color=e._oldColor?e._oldColor:u()},e.curIndex=0,e.selectItem=function(t){e.curIndex=t};var m,b=!0;e.store=function(e){m=e.slice.name},e.restore=function(e){e.slice.name=m},e.enterName=function(t){if(console.log("$scope.canInputText:",e.canInputText),t.slice.name!==m){if(!(b=o.inputValidate(t.slice.name)))return void e.restore(t);toastr.info("修改成功"),m=t.slice.name}},e.enterPress=function(t,c){13==t.keyCode&&e.enterName(c)}}]);