ide.controller("ImageSelectorInstanceCtl",["$scope","$timeout","$uibModalInstance","ProjectService","Type","ResourceService","widgetInfo","TexService",function(e,c,n,t,i,o,s,a){function r(c,n,t,i,o,s){e.canAddNewSlice=c,e.sliceNum=n,e.tex=t,e.disableEditName=i,e.disableEditImg=o,e.disableEditColor=s}function l(){e.tempSlices=_.cloneDeep(e.tex.slices)}function d(e){e.name="selectSlice.color"}function u(){c(function(){e.tex.slices=_.cloneDeep(e.tempSlices)})}function m(){return"rgba("+_.random(64,255)+","+_.random(64,255)+","+_.random(64,255)+",1.0)"}switch(e.images=o.getAllImagesAndTemplates(),e.images.unshift({name:"---",src:""}),e.basicUrl=o.getResourceUrl(),e.$on("colorpicker-submit",function(e,c){d(c)}),e.$on("colorpicker-closed",function(e,c){u()}),e.$on("colorpicker-shown",function(e,c){l()}),e.canAddNewSlice=!1,e.disableEditImg=!1,e.disableEditColor=!1,e.sliceNum=0,s.type){case i.MyButton:r(!1,2,s.tex,!1,!1,!1);break;case i.MyProgress:"1"!==s.objInfo.progressModeId&&"3"!==s.objInfo.progressModeId||1!=s.index&&2!=s.index&&3!=s.index?r(!1,1,s.tex,!0,!1,!1):r(!1,1,s.tex,!0,!0,!1),"光标纹理"===s.tex.name&&r(!1,1,s.tex,!0,!1,!0);break;case i.MySlide:r(!0,2,s.tex,!1,!1,!1);break;case i.MyNumber:r(!1,13,s.tex,!1,!1,!1);break;case i.MyDashboard:r(!1,2,s.tex,!1,!1,!1);break;case i.MyTextArea:case i.MyNum:r(!1,1,s.tex,!1,!1,!1);break;case i.MyOscilloscope:case i.MyKnob:r(!1,2,s.tex,!1,!1,!1);break;case i.MyImage:case i.MySwitch:case i.MyRotateImg:case i.MySlideBlock:r(!1,1,s.tex,!1,!1,!1);break;case i.MyAnimation:r(!0,1,s.tex,!1,!1,!1);break;case i.MyTexNum:r(!1,1,s.tex,!0,!1,!1);break;default:r(!0,1,s.tex,!1,!1,!1)}e.addSlice=function(){e.tex.slices.splice(e.curIndex+1,0,a.getDefaultSlice())},e.removeSlice=function(c){1==e.tex.slices.length?toastr.warning("至少有一张纹理"):e.tex.slices.splice(c,1)},e.save=function(){f&&n.close(e.tex)},e.cancel=function(){n.dismiss("cancel")},e.disableColorInput=function(e,c){console.log(e,c),e.imgSrc?e.color="rgba(0,0,0,0)":e.color=m()},e.curIndex=0,e.selectItem=function(c){e.curIndex=c};var x,f=!0;e.store=function(e){x=e.slice.name},e.restore=function(e){e.slice.name=x},e.enterName=function(c){if(c.slice.name!==x){if(!(f=t.inputValidate(c.slice.name)))return void e.restore(c);toastr.info("修改成功"),x=c.slice.name}},e.enterPress=function(c,n){13==c.keyCode&&e.enterName(n)}}]);