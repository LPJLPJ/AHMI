ideServices.service("LinkPageWidgetsService",[function(){function e(e){e.linkedAllWidgets=i(n(e))}function o(e,o){if(!f){var t=document.createElement("canvas");f=t.getContext("2d")}f.save(),o&&(f.font=o);var i=f.measureText(e);return f.restore(),i.width}function t(e,o,t,i,n){this.type=e,this.target=o,this.value=t,this.left=i||0,this.top=n||0}function i(e){var i,n,s=[];for(i=0;i<e.length;i++)if(n=e[i],1!=n.info.disableHighlight)switch(n.subType){case"MyButtonGroup":var f=n.info.interval,u=n.info.count,a=n.info.width,l=n.info.height,b=0,p=0,r=!1;"horizontal"==n.info.arrange?(b=(a-f*(u-1))/u,r=!0):p=(l-f*(u-1))/u;for(var h=0;h<n.info.count;h++)s.push(new t(n.subType,n,h,n.info.absoluteLeft+(r?h*(b+f):0),n.info.absoluteTop+(r?0:h*(p+f))));break;case"MyDateTime":var T,d=n.info.dateTimeModeId,y=n.info.fontSize,w=n.info.fontFamily,c=y+"px "+w;if("0"==d){T=o(":",c),n.delimiterWidth=T;var L=(n.info.width-2*T)/3;s.push(new t(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new t(n.subType,n,1,n.info.absoluteLeft+L+T,n.info.absoluteTop)),s.push(new t(n.subType,n,2,n.info.absoluteLeft+2*(L+T),n.info.absoluteTop))}else if("1"==d){T=o(":",c),n.delimiterWidth=T;var L=(n.info.width-T)/2;s.push(new t(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new t(n.subType,n,1,n.info.absoluteLeft+L+T,n.info.absoluteTop))}else if("2"==d){T=o("/",c),n.delimiterWidth=T;var L=(n.info.width-2*T)/4;s.push(new t(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new t(n.subType,n,1,n.info.absoluteLeft+2*L+T,n.info.absoluteTop)),s.push(new t(n.subType,n,2,n.info.absoluteLeft+2*(L+T)+L,n.info.absoluteTop))}else if("3"==d){T=o("-",c),n.delimiterWidth=T;var L=(n.info.width-2*T)/4;s.push(new t(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new t(n.subType,n,1,n.info.absoluteLeft+2*L+T,n.info.absoluteTop)),s.push(new t(n.subType,n,2,n.info.absoluteLeft+2*(L+T)+L,n.info.absoluteTop))}break;case"MyTexTime":var d=n.info.dateTimeModeId,v=n.info.characterW;if("0"==d){T=o(":",c),n.delimiterWidth=v;var L=(n.info.width-2*v)/3;s.push(new t(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new t(n.subType,n,1,n.info.absoluteLeft+L+v,n.info.absoluteTop)),s.push(new t(n.subType,n,2,n.info.absoluteLeft+2*(L+v),n.info.absoluteTop))}else if("1"==d){n.delimiterWidth=v;var L=(n.info.width-v)/2;s.push(new t(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new t(n.subType,n,1,n.info.absoluteLeft+L+v,n.info.absoluteTop))}else if("2"==d){n.delimiterWidth=v;var L=(n.info.width-2*v)/4;s.push(new t(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new t(n.subType,n,1,n.info.absoluteLeft+2*L+v,n.info.absoluteTop)),s.push(new t(n.subType,n,2,n.info.absoluteLeft+2*(L+v)+L,n.info.absoluteTop))}else if("3"==d){n.delimiterWidth=v;var L=(n.info.width-2*v)/4;s.push(new t(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new t(n.subType,n,1,n.info.absoluteLeft+2*L+v,n.info.absoluteTop)),s.push(new t(n.subType,n,2,n.info.absoluteLeft+2*(L+v)+L,n.info.absoluteTop))}break;case"MyInputKeyboard":var g=n.info.keys;g.forEach(function(e,o){s.push(new t(n.subType,n,o,e.x,e.y))});break;default:s.push(new t(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop))}return s.sort(function(e,o){return e.left-o.left}),s.sort(function(e,o){return e.top-o.top}),s}function n(e){for(var o,t,i,n=[],f=0,u=0;u<e.canvasList.length;u++){t=e.canvasList[u];for(var a=0;a<t.subCanvasList.length;a++){o=t.subCanvasList[a];for(var l=0;l<o.widgetList.length;l++)i=o.widgetList[l],i.wId=f++,i.info.absoluteLeft=i.info.left+t.x,i.info.absoluteTop=i.info.top+t.y;n=n.concat(o.widgetList)}}return n.filter(s)}function s(e){var o=!1;switch(e.subType){case"MyButton":case"MyButtonGroup":case"MyDateTime":case"MyTexTime":case"MyInputKeyboard":o=!0;break;default:o=!1}return o}var f;this.linkPageAllWidgets=e}]);