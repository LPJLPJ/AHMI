ideServices.service("LinkPageWidgetsService",[function(){function e(e){e.linkedAllWidgets=i(n(e))}function t(e,t){if(!f){var o=document.createElement("canvas");f=o.getContext("2d")}f.save(),t&&(f.font=t);var i=f.measureText(e);return f.restore(),i.width}function o(e,t,o,i,n){this.type=e,this.target=t,this.value=o,this.left=i||0,this.top=n||0}function i(e){var i,n,s=[];for(i=0;i<e.length;i++)switch(n=e[i],n.subType){case"MyButtonGroup":var f=n.info.interval,u=n.info.count,a=n.info.width,l=n.info.height,r=0,p=0,b=!1;"horizontal"==n.info.arrange?(r=(a-f*(u-1))/u,b=!0):p=(l-f*(u-1))/u;for(var h=0;h<n.info.count;h++)s.push(new o(n.subType,n,h,n.info.absoluteLeft+(b?h*(r+f):0),n.info.absoluteTop+(b?0:h*(p+f))));break;case"MyDateTime":var T,d=n.info.dateTimeModeId,c=n.info.fontSize,v=n.info.fontFamily,w=c+"px "+v;if("0"==d){T=t(":",w),n.delimiterWidth=T;var y=(n.info.width-2*T)/3;s.push(new o(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new o(n.subType,n,1,n.info.absoluteLeft+y+T,n.info.absoluteTop)),s.push(new o(n.subType,n,2,n.info.absoluteLeft+2*(y+T),n.info.absoluteTop))}else if("1"==d){T=t(":",w),n.delimiterWidth=T;var y=(n.info.width-T)/2;s.push(new o(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new o(n.subType,n,1,n.info.absoluteLeft+y+T,n.info.absoluteTop))}else if("2"==d){T=t("/",w),n.delimiterWidth=T;var y=(n.info.width-2*T)/4;s.push(new o(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new o(n.subType,n,1,n.info.absoluteLeft+2*y+T,n.info.absoluteTop)),s.push(new o(n.subType,n,2,n.info.absoluteLeft+2*(y+T)+y,n.info.absoluteTop))}else if("3"==d){T=t("-",w),n.delimiterWidth=T;var y=(n.info.width-2*T)/4;s.push(new o(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop)),s.push(new o(n.subType,n,1,n.info.absoluteLeft+2*y+T,n.info.absoluteTop)),s.push(new o(n.subType,n,2,n.info.absoluteLeft+2*(y+T)+y,n.info.absoluteTop))}break;default:s.push(new o(n.subType,n,0,n.info.absoluteLeft,n.info.absoluteTop))}return s.sort(function(e,t){return e.top-t.top}),s}function n(e){for(var t,o,i,n=[],f=0,u=0;u<e.canvasList.length;u++){o=e.canvasList[u];for(var a=0;a<o.subCanvasList.length;a++){t=o.subCanvasList[a];for(var l=0;l<t.widgetList.length;l++)i=t.widgetList[l],i.wId=f++,i.info.absoluteLeft=i.info.left+o.x,i.info.absoluteTop=i.info.top+o.y;n=n.concat(t.widgetList)}}return n.filter(s)}function s(e){var t=!1;switch(e.subType){case"MyButton":case"MyButtonGroup":case"MyDateTime":t=!0;break;default:t=!1}return t}var f;this.linkPageAllWidgets=e}]);