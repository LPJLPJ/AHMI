ideServices.service("ProjectTransformService",["Type",function(e){function t(e,t){return actionCompiler.transformer.trans(actionCompiler.parser.parse(e),t)}function n(e,n){if(n=n||!0,e&&e.actions&&e.actions.length)for(var r=0;r<e.actions.length;r++){var a=e.actions[r];a.commands=t(a.commands,n)}}function r(){var e=["onInitialize","onMouseUp","onMouseDown"],t={},n=WidgetModel.models;for(var r in n)if(n.hasOwnProperty(r)){var a=n[r].prototype.commands;c(a,e),t[r]=a}return t}function a(e){var t={};t.version=e.version,t.name=e.name||"default project",t.author=e.author||"author",t.size=e.currentSize,t.generalWidgetCommands=r(),t.pageList=[];for(var n=0;n<e.pages.length;n++)t.pageList.push(i(e.pages[n],n));return t}function i(t,r){var a={};a.id=""+r,a.type=e.MyPage,g(t,a,["name","backgroundImage","backgroundColor","triggers","actions","tag","transition"]),n(a),a.canvasList=[];for(var i=0;i<t.layers.length;i++)a.canvasList.push(o(t.layers[i],i,a.id));return a}function o(t,r,a){var i={};i.id=a+"."+r,i.type=e.MyLayer,g(t,i,["name","triggers","actions","tag","zIndex","animations","transition"]),n(i),i.w=t.info.width,i.h=t.info.height,i.x=t.info.left,i.y=t.info.top,i.subCanvasList=[];for(var o=0;o<t.subLayers.length;o++){var u=t.subLayers[o];t.showSubLayer.id==u&&(i.curSubCanvasIdx=o),i.subCanvasList.push(s(u,o,i.id))}return i}function s(t,r,a){var i={};i.id=a+"."+r,i.type=e.MySubLayer,g(t,i,["name","tag","actions","zIndex","backgroundImage","backgroundColor"]),n(i),i.widgetList=[];for(var o=0;o<t.widgets.length;o++){var s=t.widgets[o];i.widgetList.push(u(s,o,i.id))}return i}function u(e,t,r){var a={};if(a=_.cloneDeep(e),"general"==a.type){var i=a.info,o=i.left,s=i.top,u=i.width,c=i.height;a=new WidgetModel.models.Button(o,s,u,c,"button",null,a.texList[0].slices),a=a.toObject(),a.type="widget",a.subType="general",a.generalType="Button",a.id=r+"."+t}else n(a),a.type="widget",a.subType=e.type,a.id=r+"."+t;return a}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];d(e,r)}}function d(e,t){e[t]=WidgetModel.WidgetCommandParser.complier.transformer.trans(WidgetModel.WidgetCommandParser.complier.parser.parse(e[t])).map(function(e){return e.cmd})}function g(e,t,n){for(var r=0;r<n.length;r++){var a=n[r];"object"==typeof e[a]?t[a]=_.cloneDeep(e[a]):t[a]=e[a]}}this.transDataFile=a}]);