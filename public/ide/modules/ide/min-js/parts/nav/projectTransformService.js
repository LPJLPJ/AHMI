ideServices.service("ProjectTransformService",["Type",function(e){function t(e,t){return actionCompiler.transformer.trans(actionCompiler.parser.parse(e),t)}function n(e,n){if(n=n||!0,e&&e.actions&&e.actions.length)for(var r=0;r<e.actions.length;r++){var a=e.actions[r];a.commands=t(a.commands,n)}}function r(){var e=["onInitialize","onMouseUp","onMouseDown"],t={},n=WidgetModel.models;for(var r in n)if(n.hasOwnProperty(r)){console.log(n,r);var a=n[r].prototype.commands;console.log(a,_.cloneDeep(a)),c(a,e),t[r]=a}return t}function a(e){var t={};t.version=e.version,t.name=e.name||"default project",t.author=e.author||"author",t.size=e.currentSize,t.generalWidgetCommands=r(),t.pageList=[];for(var n=0;n<e.pages.length;n++)t.pageList.push(o(e.pages[n],n));return t}function o(t,r){var a={};a.id=""+r,a.type=e.MyPage,g(t,a,["name","backgroundImage","backgroundColor","triggers","actions","tag","transition"]),n(a),a.canvasList=[];for(var o=0;o<t.layers.length;o++)a.canvasList.push(i(t.layers[o],o,a.id));return a}function i(t,r,a){var o={};o.id=a+"."+r,o.type=e.MyLayer,g(t,o,["name","triggers","actions","tag","zIndex","animations","transition"]),n(o),o.w=t.info.width,o.h=t.info.height,o.x=t.info.left,o.y=t.info.top,o.subCanvasList=[];for(var i=0;i<t.subLayers.length;i++){var u=t.subLayers[i];t.showSubLayer.id==u&&(o.curSubCanvasIdx=i),o.subCanvasList.push(s(u,i,o.id))}return o}function s(t,r,a){var o={};o.id=a+"."+r,o.type=e.MySubLayer,g(t,o,["name","tag","actions","zIndex","backgroundImage","backgroundColor"]),n(o),o.widgetList=[];for(var i=0;i<t.widgets.length;i++){var s=t.widgets[i];o.widgetList.push(u(s,i,o.id))}return o}function u(e,t,r){var a={};if(a=_.cloneDeep(e),"general"==a.type){var o=a.info,i=o.left,s=o.top,u=o.width,c=o.height;a=new WidgetModel.models.Button(i,s,u,c,"button",null,a.texList[0].slices),a=a.toObject(),a.type="widget",a.subType="general-Button",a.id=r+"."+t}else n(a),a.type="widget",a.subType=e.type,a.id=r+"."+t;return a}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];d(e,r)}}function d(e,t){e[t]=WidgetModel.WidgetCommandParser.complier.transformer.trans(WidgetModel.WidgetCommandParser.complier.parser.parse(e[t])).map(function(e){return e.cmd})}function g(e,t,n){for(var r=0;r<n.length;r++){var a=n[r];"object"==typeof e[a]?t[a]=_.cloneDeep(e[a]):t[a]=e[a]}}this.transDataFile=a}]);