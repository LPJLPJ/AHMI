ideServices.service("ProjectTransformService",["Type",function(e){function t(e,t){return actionCompiler.transformer.trans(actionCompiler.parser.parse(e),t)}function n(e,n){if(n=n||!0,e&&e.actions&&e.actions.length)for(var a=0;a<e.actions.length;a++){var r=e.actions[a];r.commands=t(r.commands,n)}}function a(e){var t={};t.version=e.version,t.name=e.name||"default project",t.author=e.author||"author",t.size=e.currentSize,t.pageList=[];for(var n=0;n<e.pages.length;n++)t.pageList.push(r(e.pages[n],n));return t}function r(t,a){var r={};r.id=""+a,r.type=e.MyPage,u(t,r,["name","backgroundImage","backgroundColor","triggers","actions","tag","transition"]),n(r),r.canvasList=[];for(var o=0;o<t.layers.length;o++)r.canvasList.push(i(t.layers[o],o,r.id));return r}function i(t,a,r){var i={};i.id=r+"."+a,i.type=e.MyLayer,u(t,i,["name","triggers","actions","tag","zIndex","animations","transition"]),n(i),i.w=t.info.width,i.h=t.info.height,i.x=t.info.left,i.y=t.info.top,i.subCanvasList=[];for(var s=0;s<t.subLayers.length;s++){var c=t.subLayers[s];t.showSubLayer.id==c&&(i.curSubCanvasIdx=s),i.subCanvasList.push(o(c,s,i.id))}return i}function o(t,a,r){var i={};i.id=r+"."+a,i.type=e.MySubLayer,u(t,i,["name","tag","actions","zIndex","backgroundImage","backgroundColor"]),n(i),i.widgetList=[];for(var o=0;o<t.widgets.length;o++){var c=t.widgets[o];i.widgetList.push(s(c,o,i.id))}return i}function s(e,t,a){var r={};if(r=_.cloneDeep(e),"general"==r.type){var i=r.info,o=i.left,s=i.top,u=i.width,c=i.height;r=new WidgetModel.Button(o,s,u,c,"button",null,r.texList[0].slices),r=r.toObject(),r.type="widget",r.subType="general-Button",r.id=a+"."+t}else n(r),r.type="widget",r.subType=e.type,r.id=a+"."+t;return r}function u(e,t,n){for(var a=0;a<n.length;a++){var r=n[a];"object"==typeof e[r]?t[r]=_.cloneDeep(e[r]):t[r]=e[r]}}this.transDataFile=a}]);